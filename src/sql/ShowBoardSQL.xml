<?xml version="1.0" encoding="EUC-KR"?>
<!DOCTYPE sqlMap PUBLIC 
	'-//ibatis.apache.org/DTD Sql Map 2.0//EN'
	'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="show">
    <typeAlias alias="show" type="admin.showcase.showVO" />

    <resultMap id="Res" class="show">
        <result property="showboard_num" column="showboard_num" />
        <result property="subject" column="subject" />
        <result property="address1" column="address1" />
        <result property="address2" column="address2" />
        <result property="date" column="date" />
        <result property="pay" column="pay" />
        <result property="tel" column="tel" />
        <result property="tag" column="tag" />
        <result property="content" column="content" />
        <result property="file_orgname" column="file_orgname" />
        <result property="file_savname" column="file_savname" />
        <result property="readcount" column="readcount" />
        <result property="ordercount" column="ordercount" />
        <result property="map" column="map" />
        <result property="status" column="status" />
        <result property="showboard_category" column="showboard_category" />
    </resultMap>
    
    <!-- select 정의 -->
    <sql id="select-all">
        SELECT * FROM NOTICE
    </sql>
    
    <!-- where 정의 -->
    <sql id="where-no">
        WHERE showboard_num=#showboard_num#
    </sql>

    <!-- select 쿼리문 정의 -->
    <select id="selectall" resultMap="showRes">
        <include refid="select-all"/>
        ORDER BY showboard_num DESC
    </select>
    <select id="select" resultMap="showRes">
        <include refid="select-all"/>
        WHERE
        subject=#subject#
    </select>
    <select id="selectOne" resultMap="showRes">
        <include refid="select-all"/>
        <include refid="where-no"/>
    </select>
    <select id="selectOn" resultMap="showRes"><!-- 전시가 열린 것만 뽑기위한 sql -->
        <include refid="select-all"/>
        WHERE
        status=0
    </select>
    <select id="selectLastNo" resultClass="show" parameterClass="int">
        <include refid="select-all"/>
        ORDER BY showboard_num DESC LIMIT 1
    </select>
    
    <!-- 행사 검색(수호) 08.25.04:00  -->
    <select id="selectSearch" parameterClass="string" resultMap="showRes">
        <include refid="select-all"/>
        WHERE showboard_num like #searchKeyword#
        ORDER BY showboard_num DESC
    </select>
    <!-- 마지막 등록 행사 검색(수호) 08.25.04:50 -->
<!--    <select id="selectLastNum" resultClass="show">
        SELECT max(showboard_num)
        as showboard_num FROM showboard
    </select>-->

    <!-- insert 쿼리문 정의 -->
    <insert id="insert" parameterClass="show">
        INSERT INTO GOODS(showboard_num, subject, address1, address2, date, pay, tel tag, content, 
        file_orgname, file_savname, readcount, ordercount, map)
        
        VALUES(showboard_num_SEQ.NEXTVAL, #showboard_num#, #subject#, #address1#, #address2#, #date#, #pay#, #tel#, #tag#, #content#, 
        #file_orgname#, #file_savname#, #readcount#, #ordercount#, #map#)
    </insert>

    <!-- update 쿼리문 정의 -->
    <update id="update" parameterClass="show">
        UPDATE SHOWBOARD SET
        subject=#subject#,
        address1=#address1#,
        address2=#address2#,
        pay=#pay#,
        tel=#tel#,
        tag=#tag#,
        content=#content#,
        map=#map#,
        showboard_category=#showboard_category#
        <include refid="where-no"/>
    </update>
    
    <update id="updatestatus" parameterClass="show"><!-- 기간 지난 전시글 숨기기 -->
        UPDATE SHOWBOARD SET
        status=#status#
        <include refid="where-no"/>
    </update>

    <update id="updatefile" parameterClass="show"><!-- 사진변경용 -->
        UPDATE SHOWBOARD SET
        file_orgname=#file_orgname#,
        file_savname=#file_savname#
        <include refid="where-no"/>
    </update>
    
    <update id="readcount" parameterClass="show"><!-- 조회수증가 -->
        UPDATE SHOWBOARD SET readcount = readcount + 1
        <include refid="where-no"/>
    </update>

    <!-- delete 쿼리문 정의 -->
    <delete id="delete" parameterClass="show">
        DELETE FROM SHOWBOARD
        <include refid="where-no"/>
    </delete>

</sqlMap>
	
		
	