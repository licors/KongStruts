<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC 
	'-//ibatis.apache.org/DTD Sql Map 2.0//EN'
	'http://ibatis.apache.org/dtd/sql-map-2.dtd'>

<sqlMap>
	<typeAlias alias="order" type="order.OrderVO" />

	<resultMap id="orderRes" class="order">
		<result property="order_num" column="order_num" />
		<result property="member_num" column="member_num" />
		<result property="showboard_num" column="showboard_num" />
		<result property="name" column="name" />
		<result property="sex" column="sex" />
		<result property="company" column="company" />
		<result property="address" column="address" />
		<result property="email" column="email" />
		<result property="qrcode" column="qrcode" />
		<result property="order_date" column="order_date" />
		<result property="tel" column="tel" />
		<result property="status" column="status" />
		<result property="subject" column="subject" />
		<result property="file_orgname" column="file_orgname" />
		<result property="file_savname" column="file_savname" />
		<result property="date" column="date" />
		<result property="address2" column="address2" />
		<result property="readcount" column="readcount" />
		<result property="ordercount" column="ordercount" />
	</resultMap>


	<!-- list 보이기 -->
	<sql id="select-all">
		select od.ORDER_NUM, od.MEMBER_NUM, od.NAME, od.SEX, od.COMPANY,
		od.ADDRESS, od.EMAIL, od.QRCODE, od.ORDER_DATE, od.TEL, od.STATUS
		sb.SUBJECT, sb.FILE_ORGNAME, sb.FILE_SAVNAME, sb."DATE", sb.ADDRESS2,
		sb.READCOUNT, sb.ORDERCOUNT
		from ORDER od join SHOWBOARD sb
		on od.SHOWBOARD_NUM=sb.SHOWBOARD_NUM
	</sql>

	<!-- select -->
	<select id="order_selectOne" resultMap="orderRes">
		<include refid="select-all" />
		and od.MEMBER_NUM=#member_num#
		and sb.SUBJECT=#subject#
	</select>
	
	<select id="orderDetail" resultMap="orderRes" parameterClass="int">
		<include refid="select-all" />
		and od.ORDER_NUM=#order_num#
	</select>
	
	<select id="orderList" resultMap="orderRes" parameterClass="string">
		<include refid="select-all" />
		and od.MEMBER_NUM=#member_num#
		order by od.ORDER_NUM DESC
	</select>
	
	<!-- insert -->
	<insert id="insert_order" parameterClass="order">
		INSERT INTO
		ORDER(ORDER_NUM, MEMBER_NUM, SHOWBOARD_NUM, NAME, SEX, COMPANY,
		ADDRESS, EMAIL, QRCODE, ORDER_DATE, TEL, STATUS)
		VALUES (ORDER_NUM_SEQ.NEXTVAL,
		#member_num#, #showboard_num#, #name#, #sex#, #company#,
		#address#, #email#, #qrcode#, #order_date#, #tel#, #status#)
	</insert>
	
	<!-- delete -->
	<delete id="orderDelete" parameterClass="order">
		DELETE FROM ORDER
		WHERE ORDER_NUM=#ORDER_NUM#
	</delete>
	
	
</sqlMap>

